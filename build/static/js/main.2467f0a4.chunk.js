(this["webpackJsonpblog-frontend"]=this["webpackJsonpblog-frontend"]||[]).push([[0],{16:function(e,t,n){},23:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(1),a=n.n(c),s=n(17),u=n.n(s),i=(n(23),n(2)),o=n.n(i),l=n(5),j=n(4),b=n(6),d=n.n(b),p="/api/blogs",f=null,O={getAll:function(){var e=Object(l.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.a.get(p),e.next=3,t;case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),createBlog:function(){var e=Object(l.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:f}},e.next=3,d.a.post(p,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(l.a)(o.a.mark((function e(t,n){var r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=d.a.put("".concat(p," /").concat(t),n),e.next=3,r;case 3:return c=e.sent,e.abrupt("return",c.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),setToken:function(e){f="bearer ".concat(e)}},h=(n(16),function(e){var t=e.message;return null===t?null:Object(r.jsx)("div",{className:"error",children:t})}),v={login:function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},g=function(e){var t=e.handleLogin,n=Object(c.useState)(""),a=Object(j.a)(n,2),s=a[0],u=a[1],i=Object(c.useState)(""),b=Object(j.a)(i,2),d=b[0],p=b[1],f=function(){var e=Object(l.a)(o.a.mark((function e(n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,v.login({username:s,password:d});case 3:r=e.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(r)),t(r),u(""),p("");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:"Login"}),Object(r.jsxs)("form",{onSubmit:f,children:[Object(r.jsxs)("div",{children:["username",Object(r.jsx)("input",{type:"text",value:s,name:"Username",onChange:function(e){u(e.target.value)}})]}),Object(r.jsxs)("div",{children:["password",Object(r.jsx)("input",{type:"password",value:d,name:"Password",onChange:function(e){p(e.target.value)}})]}),Object(r.jsx)("button",{type:"submit",children:"login"})]})]})},x=a.a.forwardRef((function(e,t){var n=Object(c.useState)(!1),a=Object(j.a)(n,2),s=a[0],u=a[1],i={display:s?"none":""},o={display:s?"":"none"},l=function(){u(!s)};return Object(c.useImperativeHandle)(t,(function(){return{toggleVisibility:l}})),Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{style:i,children:Object(r.jsx)("button",{onClick:l,children:e.buttonLabel})}),Object(r.jsxs)("div",{style:o,children:[e.children,Object(r.jsx)("button",{onClick:l,children:"cancel"})]})]})})),m=function(e){var t=e.blog;return Object(r.jsxs)("div",{children:[Object(r.jsx)("b",{children:"Title: "})," ",t.title," ",Object(r.jsx)("b",{children:"Likes: "})," ",t.likes,Object(r.jsx)("hr",{})]})},w=function(e){var t=e.createBlog,n=e.blogs,a=Object(c.useState)(""),s=Object(j.a)(a,2),u=s[0],i=s[1],o=Object(c.useState)(""),l=Object(j.a)(o,2),b=l[0],d=l[1],p=Object(c.useState)(""),f=Object(j.a)(p,2),O=f[0],h=f[1];return Object(r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({title:u,author:b,content:O}),i(""),d(""),h("")},children:[Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{children:["Title:",Object(r.jsx)("input",{type:"text",value:u,onChange:function(e){i(e.target.value)}})]}),Object(r.jsxs)("div",{children:["Author:",Object(r.jsx)("input",{type:"text",value:b,onChange:function(e){d(e.target.vale)}})]}),Object(r.jsxs)("div",{children:["Content:",Object(r.jsx)("input",{type:"text",value:O,onChange:function(e){h(e.target.value)}})]}),Object(r.jsx)("button",{type:"submit",children:"Add"})]}),Object(r.jsx)("div",{children:n.map((function(e){return Object(r.jsx)(m,{blog:e},e.id)}))})]})},y=function(){var e=Object(c.useState)([]),t=Object(j.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(null),u=Object(j.a)(s,2),i=u[0],b=u[1],d=Object(c.useState)(null),p=Object(j.a)(d,2),f=p[0],v=p[1];Object(c.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.getAll();case 2:t=e.sent,a(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(c.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);b(t),O.setToken(t.token)}}),[]);var m=function(e){try{O.setToken(e.token),b(e)}catch(t){v("Wrong credentials"),setTimeout((function(){v(null)}),5e3)}},y=function(){var e=Object(l.a)(o.a.mark((function e(t){var r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k.current.toggleVisibility(),r=O.createBlog(t),e.next=4,r;case 4:c=e.sent,a(n.concat(c));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();console.log(i);var k=Object(c.useRef)();return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsx)("h2",{children:"Blogs"}),Object(r.jsx)(h,{message:f}),null===i?Object(r.jsx)(x,{buttonLabel:"login",children:Object(r.jsx)(g,{handleLogin:m})}):Object(r.jsxs)("div",{children:[Object(r.jsxs)("p",{children:[i.name," logged-in",Object(r.jsx)("button",{onClick:function(){window.localStorage.removeItem("loggedBlogappUser")},children:"Log out"})]}),Object(r.jsx)(x,{buttonLabel:"new note",ref:k,children:Object(r.jsx)(w,{createBlog:y,blogs:n})})]})]})};u.a.render(Object(r.jsx)(y,{}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.2467f0a4.chunk.js.map